from src import utils
import pandas as pd
import yaml
from src.models.BQMBuilder import BcosQmatPaper
from src.models.QuboSolver import QuboSolver
from src.models.RandomSolver import RandomSolver
from src.models.Evaluator import Evaluator
from box import ConfigBox
from sklearn.datasets import load_svmlight_file
from tqdm import tqdm

# Load config
with open("config/config_bcos_run.yml", "r") as file:
    config = ConfigBox(yaml.safe_load(file))

results_per_fold = []
for i in tqdm(range(5)):
    X, y = load_svmlight_file(f"data/llm/train{i}", n_features=4096)
    X_dense = pd.DataFrame(X.toarray())


    bcos_model = QuboSolver(X=X_dense, Y=y, **config.instance_selection)
    bcos_results = bcos_model.run_QuboSolver(BcosQmatPaper)
    results_per_fold.append(bcos_results)
    
print('a')